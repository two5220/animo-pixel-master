<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Animo Pixel Master - ì œë¯¸ë‚˜ì´ ì›Œí„°ë§ˆí¬ ì œê±° & ì´ë¯¸ì§€ ë¶„í• /ì••ì¶• ë„êµ¬</title>
    <meta name="description" content="AI ì›Œí„°ë§ˆí¬ ì œê±°, ì¸ìŠ¤íƒ€ê·¸ë¨ìš© ì´ë¯¸ì§€ ë¶„í• , ê³ í™”ì§ˆ ìš©ëŸ‰ ì••ì¶•ì„ ë¬´ë£Œë¡œ ì œê³µí•©ë‹ˆë‹¤. ì„œë²„ ì—…ë¡œë“œ ì—†ëŠ” ì•ˆì „í•œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ì´ë¯¸ì§€ ì²˜ë¦¬ ë„êµ¬ì…ë‹ˆë‹¤.">
    <meta name="keywords" content="ì´ë¯¸ì§€ ë¶„í• , ì›Œí„°ë§ˆí¬ ì œê±°, ì œë¯¸ë‚˜ì´, ì‚¬ì§„ ìš©ëŸ‰ ì¤„ì´ê¸°, ì¸ìŠ¤íƒ€ê·¸ë¨ ê·¸ë¦¬ë“œ, ì´ë¯¸ì§€ ìë¥´ê¸°, ë¬´ë£Œ ì›¹íˆ´">
    <meta name="author" content="Animo">
    <meta property="og:title" content="Animo Pixel Master">
    <meta property="og:description" content="ì„¤ì¹˜ ì—†ì´ ë°”ë¡œ ì“°ëŠ” ê°•ë ¥í•œ ì´ë¯¸ì§€ í¸ì§‘ ë„êµ¬. ì›Œí„°ë§ˆí¬ ì œê±°ë¶€í„° ë¶„í•  ì €ì¥ê¹Œì§€.">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#121212">
    <link rel="apple-touch-icon" href="icon.png"> 
    <link rel="manifest" href="manifest.json">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        /* [ê³µí†µ ë³€ìˆ˜] */
        :root { 
            --primary: #00e676; 
            --primary-dim: rgba(0, 230, 118, 0.1);
            --bg-dark: #121212; 
            --panel-bg: #1e1e1e; 
            --surface: #252525;
            --border: #333; 
            --text-main: #ffffff;
            --text-sub: #aaaaaa;
            --danger: #ff5252;
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-sm: 8px;
            --gem-accent: #4285f4;
        }
        
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; 
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at 50% 0%, #1a3a2a 0%, #121212 60%);
            color: var(--text-main); 
            margin: 0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; padding-bottom: 50px;
        }
        
        /* ìˆ«ì ì…ë ¥ í™”ì‚´í‘œ ì œê±° */
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* [PC ì „ìš© ë ˆì´ì•„ì›ƒ: 1024px ì´ìƒ] */
        @media (min-width: 1024px) {
            .container { max-width: 1400px !important; padding: 3rem !important; }
            .dashboard-layout { display: flex; gap: 25px; align-items: flex-start; margin-top: 20px; text-align: left; }
            .workspace-left { flex: 4; min-width: 0; }
            #previewContainer { height: 650px !important; margin-bottom: 0 !important; }
            .workspace-right { flex: 1; min-width: 280px; max-width: 340px; background: var(--surface); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border); }
            
            .pc-tab-menu { display: flex !important; gap: 5px; margin-bottom: 15px; }
            .tab-btn { flex: 1; height: 60px !important; padding: 5px !important; line-height: 1.3 !important; white-space: pre-wrap !important; display: flex !important; justify-content: center; align-items: center; text-align: center; border-radius: 12px !important; font-size: 1.15rem !important; }
            .pc-br { display: inline !important; }
            
            .pc-controls-wrapper { display: flex !important; gap: 15px; margin-bottom: 15px; padding: 15px; background: #181818; border-radius: 12px; border: 1px solid #333; }
            .btn-group-vertical { display: flex !important; flex-direction: column !important; gap: 8px !important; width: 45px; flex-shrink: 0; }
            
            /* + ë²„íŠ¼ ì¤‘ì•™ ì •ë ¬ ë° 3ë°° í™•ëŒ€ */
            .tab-attach { 
                width: 100% !important; 
                height: 40px !important; 
                border-radius: 8px !important; 
                font-size: 1.8rem !important; 
                line-height: 1 !important;
                margin: 0 !important; 
                display: flex !important; 
                justify-content: center !important; 
                align-items: center !important; 
                padding: 0 !important;
                padding-bottom: 4px !important; 
            }
            .tab-delete { width: 100% !important; height: 40px !important; border-radius: 8px !important; font-size: 1rem !important; margin: 0 !important; }
            
            .chk-group-vertical { display: flex !important; flex-direction: column !important; justify-content: center; gap: 10px !important; align-items: flex-start !important; width: 100%; }
            
            #splitPanel, #cropPanel { grid-template-columns: 1fr 1fr !important; padding: 15px !important; background: rgba(0,0,0,0.2) !important; margin-bottom: 15px !important; }
            #splitPanel { grid-template-columns: 1fr 1fr 1fr !important; gap: 10px !important; }
            #splitPanel .input-group:nth-child(3) { grid-column: auto !important; }
            
            .ratio-select-wrapper { width: 100%; grid-column: span 2; position: relative; }
            .ratio-select { 
                width: 100%; 
                padding: 9px 12px; 
                padding-right: 50px; 
                background: #151515; color: #fff; border: 1px solid #333; border-radius: 10px; 
                font-size: 0.9rem; font-weight: bold; cursor: pointer; outline: none; 
                appearance: none; -webkit-appearance: none; -moz-appearance: none;
                text-align: center; 
                text-align-last: center; 
                background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
                background-repeat: no-repeat;
                background-position: right 5px center;
                background-size: 30px;
            }
            .ratio-select:hover { border-color: var(--primary); }
            
            /* ë¹„ìœ¨ ì…ë ¥ë€ */
            .ratio-inputs-row { 
                display: flex !important; gap: 10px !important; width: 100%; grid-column: span 2; 
                margin-top: 3px !important; 
            }
            .ratio-inputs-row input { 
                flex: 1; text-align: center; 
                padding: 9px 0 !important; 
            }
            
            #splitPanel .input-group:last-child { grid-column: 1 / -1 !important; }
            #splitPanel .ratio-select-wrapper { grid-column: auto !important; width: 100%; }
            #splitPanel .ratio-inputs-row { grid-column: auto !important; }

            .main-btn { padding: 18px !important; font-size: 1.1rem !important; width: 100%; }
            
            .info-container { max-width: 1400px !important; display: grid !important; grid-template-columns: 1fr 1fr !important; gap: 30px !important; }
            .features-grid { max-width: 1400px !important; grid-template-columns: repeat(3, 1fr) !important; }
            .gemini-section { max-width: 1400px !important; }

            /* ì••ì¶• ìš©ëŸ‰ ë²„íŠ¼ */
            .preset-btns { 
                display: grid; grid-template-columns: repeat(2, 1fr); 
                gap: 15px !important; 
                margin-top: 5px; height: 100%; width: 100%; 
            }
            .preset-btn { 
                background: #2d2d2d; border: 2px solid #333; color: #ccc; font-size: 0.9rem; 
                padding: 9px 0 !important; 
                border-radius: 12px; cursor: pointer; transition: all 0.2s; display: flex; justify-content: center; align-items: center; font-weight: 800; 
            }
            .preset-btn:hover { border-color: #777; background: #383838; color: #fff; }
            .preset-btn.active { 
                border: 2px solid var(--primary); 
                color: #fff; background: linear-gradient(180deg, rgba(0,230,118,0.1) 0%, rgba(0,230,118,0.2) 100%); 
                box-shadow: 0 4px 12px rgba(0,230,118,0.2); 
            }
        }

        /* [ëª¨ë°”ì¼ìš© ìŠ¤íƒ€ì¼] */
        .pc-br { display: none; }
        .ratio-inputs-row { display: flex; gap: 10px; width: 100%; margin-top: 10px; }
        .ratio-select-wrapper { width: 100%; position: relative; }
        
        /* [ìˆ˜ì •] ëª¨ë°”ì¼ í™”ì‚´í‘œ 150% í™•ëŒ€ ë° í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
        .ratio-select { 
            width: 100%; padding: 12px; padding-right: 50px;
            background: #151515; color: #fff; border: 1px solid #333; border-radius: 10px; 
            font-size: 1rem; font-weight: bold; cursor: pointer; outline: none; appearance: none;
            text-align: center; /* í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
            text-align-last: center; /* ëª¨ë°”ì¼ ë“œë¡­ë‹¤ìš´ í…ìŠ¤íŠ¸ ì¤‘ì•™ */
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 5px top 50%;
            background-size: 30px; /* 30pxë¡œ í™•ëŒ€ */
        }

        @media (max-width: 1023px) {
            #splitPanel { grid-template-columns: 1fr 1fr 1fr !important; gap: 10px; }
            #splitPanel .input-group:last-child { grid-column: 1 / -1 !important; margin-top: 5px; }

            /* [ìˆ˜ì •] ì»¨íŠ¸ë¡¤ ë°•ìŠ¤: ë²„íŠ¼ì€ ì™¼ìª½ ì„¸ë¡œ ì •ë ¬, ì²´í¬ë°•ìŠ¤ëŠ” ì˜¤ë¥¸ìª½ ì„¸ë¡œ ì •ë ¬ */
            .pc-controls-wrapper { 
                display: flex !important; 
                flex-direction: row !important; /* ê°€ë¡œ ë°°ì¹˜ */
                gap: 40px !important; /* ë²„íŠ¼ê³¼ ì²´í¬ë°•ìŠ¤ ì‚¬ì´ ì—¬ìœ ë¡œìš´ ê°„ê²© */
                justify-content: center; /* ì¤‘ì•™ ì •ë ¬ */
                align-items: center;
                background: #181818; 
                padding: 15px; 
                border-radius: 12px; 
                border: 1px solid #333; 
                margin-bottom: 15px;
            } 

            /* [ìˆ˜ì •] ë²„íŠ¼ ê·¸ë£¹: ì™¼ìª½ ì„¸ë¡œ ì •ë ¬ */
            .btn-group-vertical { 
                display: flex !important; 
                flex-direction: column !important; 
                gap: 12px !important; 
                align-items: center; 
                width: auto;
            }

            /* [ìˆ˜ì •] ì²´í¬ë°•ìŠ¤ ê·¸ë£¹: ì˜¤ë¥¸ìª½ ì„¸ë¡œ ì •ë ¬, ì—¬ë°± í™•ëŒ€ */
            .chk-group-vertical { 
                display: flex !important; 
                flex-direction: column !important; 
                justify-content: center; 
                gap: 20px !important; /* ì²´í¬ë°•ìŠ¤ ì‚¬ì´ ê³µê°„ 100% í™•ëŒ€ (ê¸°ì¡´ ì•½ 10px -> 20px) */
                align-items: flex-start !important; 
                width: auto; 
                padding: 0 !important;
                margin: 0 !important;
                background: transparent !important;
                border: none !important;
            }

            /* [ìˆ˜ì •] ì²´í¬ë°•ìŠ¤ ê¸€ì”¨ í™•ëŒ€ */
            .chk-label { 
                display: flex; align-items: center; gap: 8px; 
                font-size: 1.25rem !important; /* ê¸€ì”¨ í¬ê¸° 30% í™•ëŒ€ (0.95rem -> 1.25rem) */
                cursor: pointer; color: #ccc; 
            }
            .chk-label input { width: 22px; height: 22px; }

            .tab-attach { 
                width: 44px; height: 44px; border-radius: 10px; 
                display: flex; justify-content: center; align-items: center; 
                font-weight: 900; font-size: 1.8rem; /* ë²„íŠ¼ í°íŠ¸ ìœ ì§€ */
                padding-bottom: 4px;
                background: #2a2a2a;
            }
            .tab-delete { 
                width: 44px; height: 44px; border-radius: 10px; 
                display: flex; justify-content: center; align-items: center; 
                font-weight: 900; 
                background: #2a2a2a; 
            }
            
            .pc-tab-menu { display: contents; } 
            
            .preset-btn { 
                padding: 15px 0 !important; /* ëª¨ë°”ì¼ì€ ê¸°ì¡´ í¬ê¸° ìœ ì§€ */
            }
        }

        /* [ê³µí†µ ìŠ¤íƒ€ì¼] */
        .container { background: var(--panel-bg); padding: 2rem; border-radius: var(--radius-lg); box-shadow: 0 20px 60px rgba(0,0,0,0.5); text-align: center; width: 95%; max-width: 620px; border: 1px solid rgba(255,255,255,0.05); z-index: 10; position: relative; margin-top: 5vh; margin-bottom: 2rem; }
        .header-wrap { display: flex; justify-content: center; align-items: center; margin-bottom: 1.2rem; position: relative; width: 100%; }
        @media (min-width: 1024px) { .header-wrap { justify-content: center; } }
        
        h1 { color: var(--primary); margin: 0; font-weight: 900; font-size: 2.4rem; letter-spacing: -0.5px; background: linear-gradient(135deg, #00e676 0%, #69f0ae 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .sub-text { color: var(--text-sub); font-size: 1.15rem; margin-bottom: 2rem; font-weight: 500; line-height: 1.5; text-align: center; }
        
        .preview-top-bar { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 8px; padding: 0 2px; }
        .counter-box { font-size: 0.8rem; color: #777; font-weight: 700; display: flex; align-items: center; gap: 5px; }
        .counter-box b { color: var(--primary); font-size: 0.9rem; }
        .lang-wrapper { display: flex; align-items: center; gap: 8px; }
        .flag-icon { width: 25px; height: 18px; border-radius: 2px; }
        .lang-select { background: #222; border: 1px solid #444; color: #888; font-size: 0.9rem; font-weight: bold; padding: 3px 8px; border-radius: 6px; cursor: pointer; }

        #previewContainer { width: 100%; height: 340px; background: #000; border-radius: var(--radius-md); margin-bottom: 1.5rem; border: 1px solid #333; position: relative; display: flex; justify-content: center; align-items: center; overflow: hidden; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); }
        #previewCanvas { max-width: 100%; max-height: 100%; object-fit: contain; cursor: crosshair; position: relative; z-index: 2; }
        #guideText { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #555; z-index: 1; pointer-events: none; padding: 20px; }
        #guideText .main-guide { font-size: 1.2rem; font-weight: 700; margin-bottom: 12px; color: #777; }
        #guideText .sub-guide { font-size: 0.85rem; line-height: 1.6; color: #555; }

        .tab-menu { display: flex; align-items: center; gap: 4px; margin-bottom: 1.5rem; padding: 4px; background: #151515; border-radius: 12px; border: 1px solid #2a2a2a; }
        .tab-btn { flex: 1; background: transparent; border: none; color: #666; font-size: 0.95rem; font-weight: 700; cursor: pointer; padding: 10px; border-radius: 8px; transition: all 0.2s ease; }
        .tab-btn.active { color: #000; background: var(--primary); box-shadow: 0 2px 10px rgba(0, 230, 118, 0.2); }
        
        .tab-attach { background: var(--surface); color: var(--primary); border: 1px solid #333; cursor: pointer; display:flex; justify-content:center; align-items:center;}
        .tab-delete { background: var(--surface); color: var(--danger); border: 1px solid #333; font-size: 0.75rem; cursor: pointer; display:flex; justify-content:center; align-items:center;}

        /* PCìš© .chk-labelì€ ì•„ë˜ ë¯¸ë””ì–´ì¿¼ë¦¬ ë°–ì—ì„œ ì •ì˜ */
        .chk-label { display: flex; align-items: center; gap: 4px; font-size: 0.95rem; cursor: pointer; color: #ccc; }
        .chk-label input { accent-color: var(--primary); width: 18px; height: 18px; }

        .config-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; background: var(--surface); padding: 20px; border-radius: var(--radius-md); margin-bottom: 1.5rem; border: 1px solid var(--border); text-align: left; }
        .input-group { display: flex; flex-direction: column; gap: 8px; width: 100%; align-items: center; } 
        label { font-size: 0.85rem; color: #888; font-weight: 700; margin-left: 0; text-align: center; width: 100%; white-space: nowrap; }
        
        /* ì…ë ¥ ìˆ«ì ì¤‘ì•™ ì •ë ¬ */
        .input-num { background: #151515; border: 1px solid #333; color: #fff; padding: 12px 0; border-radius: 10px; font-weight: bold; font-size: 1.1rem; width: 100%; text-align: center; }

        .preset-btns { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 5px; height: 100%; }
        .preset-btn { background: #2d2d2d; border: 1px solid #444; color: #ccc; font-size: 0.9rem; padding: 15px 0; border-radius: 12px; cursor: pointer; transition: all 0.2s; display: flex; justify-content: center; align-items: center; font-weight: 800; }
        .preset-btn:hover { border-color: #777; background: #383838; color: #fff; }
        .preset-btn.active { border: 2px solid var(--primary); color: #fff; background: linear-gradient(180deg, rgba(0,230,118,0.1) 0%, rgba(0,230,118,0.2) 100%); box-shadow: 0 4px 12px rgba(0,230,118,0.2); }
        .preset-btn span { display: block; }

        .btn-original { background: #333; border: 1px solid #444; color: #fff; font-size: 0.9rem; font-weight: 800; border-radius: 10px; cursor: pointer; transition: all 0.2s; display: flex; justify-content: center; align-items: center; height: 100%; }
        .btn-original:hover { border-color: var(--primary); color: var(--primary); }
        .btn-original.active { background: var(--primary); color: #000; border-color: var(--primary); }
        .btn-original:disabled { opacity: 0.3; cursor: not-allowed; }

        .input-wrapper { position: relative; width: 100%; }
        /* ì…ë ¥ì¹¸ íŒ¨ë”© ì œê±°í•˜ì—¬ ì™„ì „í•œ ì¤‘ì•™ ì •ë ¬ */
        .input-wrapper input { padding-right: 0 !important; width: 100%; text-align: center !important; }
        .input-unit { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #888; font-weight: 800; font-size: 0.85rem; pointer-events: none; }

        .action-row { display: flex; flex-direction: column; gap: 12px; margin-bottom: 1.5rem; align-items: stretch; }
        .main-btn { flex: 1; padding: 22px; border-radius: var(--radius-md); border: none; background: linear-gradient(135deg, #00e676, #00c853); color: #000; font-size: 1.25rem; font-weight: 900; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 10px 30px rgba(0,230,118,0.2); }
        .main-btn:hover { transform: translateY(-2px); box-shadow: 0 15px 40px rgba(0,230,118,0.3); }
        
        .donation-btn { flex: 0 0 auto; display: flex; justify-content: center; align-items: center; text-align: center; background: #ffe812; color: #3c1e1e; padding: 12px; border-radius: var(--radius-md); cursor: pointer; border: none; width: 100%; font-weight: 800; font-size: 0.9rem; line-height: 1.4; white-space: pre-wrap; transition: transform 0.2s; }
        .donation-btn:hover { transform: translateY(-2px); }

        /* í•˜ë‹¨ ìš”ì†Œë“¤ */
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-bottom: 2rem; width: 95%; max-width: 620px; }
        .feature-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 1.5rem; text-align: left; transition: transform 0.2s; border-color: #333; }
        .feature-card:hover { transform: translateY(-5px); border-color: var(--primary); }
        .feat-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; justify-content: center; align-items: center; margin-bottom: 1rem; font-size: 1.2rem; }
        .feat-title { font-size: 1.1rem; font-weight: 800; color: var(--text-main); margin-bottom: 0.5rem; }
        .feat-desc { font-size: 0.85rem; color: var(--text-sub); line-height: 1.5; }
        .bg-fast { background: rgba(0, 230, 118, 0.15); color: #00e676; }
        .bg-priv { background: rgba(66, 133, 244, 0.15); color: #4285f4; }
        .bg-free { background: rgba(170, 0, 255, 0.15); color: #aa00ff; }

        .gemini-section { background: linear-gradient(135deg, #1e1e1e 0%, #151515 100%); border: 1px solid #333; border-radius: var(--radius-lg); padding: 2rem; margin-bottom: 2rem; width: 95%; max-width: 620px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .gemini-title { color: var(--gem-accent); font-size: 1.2rem; font-weight: 900; margin-bottom: 1rem; letter-spacing: -0.5px; }
        .gemini-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 1.5rem; }
        .gem-btn { background: #252525; border: 1px solid #444; color: #eee; padding: 15px 10px; border-radius: 12px; cursor: pointer; font-size: 0.85rem; font-weight: 700; transition: all 0.2s; display: flex; flex-direction: column; gap: 5px; align-items: center; }
        .gem-btn:hover { border-color: var(--gem-accent); background: rgba(66, 133, 244, 0.05); transform: translateY(-2px); }
        .gem-btn .icon { font-size: 1.4rem; }
        .gem-tip-box { background: #0f0f0f; border-left: 4px solid var(--gem-accent); padding: 12px; text-align: left; border-radius: 0 8px 8px 0; font-size: 0.8rem; color: #999; line-height: 1.6; }
        .gem-tip-box strong { color: var(--gem-accent); display: block; margin-bottom: 4px; font-size: 0.85rem; }

        .info-container { width: 95%; max-width: 620px; color: #888; text-align: left; margin-bottom: 50px; }
        .info-section { background: #181818; border: 1px solid #2a2a2a; border-radius: var(--radius-md); padding: 2rem; margin-bottom: 2rem; }
        .info-title { color: var(--primary); font-size: 1.1rem; font-weight: 800; margin-bottom: 1rem; display: flex; align-items: center; gap: 8px; }
        .info-text { font-size: 0.9rem; line-height: 1.7; margin-bottom: 1rem; color: #aaa; }
        .feature-list { list-style: none; padding: 0; margin: 0; }
        .feature-list li { margin-bottom: 10px; position: relative; padding-left: 15px; font-size: 0.9rem; }
        .feature-list li::before { content: 'â€¢'; color: var(--primary); position: absolute; left: 0; font-weight: bold; }
        .footer-links { text-align: center; margin-top: 20px; font-size: 0.8rem; }
        .footer-links span { cursor: pointer; color: #555; text-decoration: underline; margin: 0 10px; }
        .footer-links span:hover { color: var(--primary); }

        .qr-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 20000; justify-content: center; align-items: center; backdrop-filter: blur(8px); }
        .qr-modal.active { display: flex; animation: fadeIn 0.2s ease-out; }
        .qr-box { background: #fff; padding: 30px; border-radius: 24px; text-align: center; max-width: 340px; width: 90%; box-shadow: 0 20px 50px rgba(0,0,0,0.5); position: relative; }
        .qr-img { width: 100%; height: auto; display: block; border-radius: 12px; border: 1px solid #eee; }
        .close-qr { margin-top: 20px; padding: 14px 0; width: 100%; background: #222; color: #fff; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; }
        .prompt-view { background: #111; color: #00e676; padding: 15px; border-radius: 12px; font-family: monospace; font-size: 0.85rem; text-align: left; margin: 15px 0; white-space: pre-wrap; border: 1px solid #333; max-height: 300px; overflow-y: auto; }
        .copy-btn { width: 100%; padding: 12px; background: var(--gem-accent); color: white; border: none; border-radius: 10px; font-weight: 800; cursor: pointer; margin-bottom: 10px; }
        .policy-content { max-height: 60vh; overflow-y: auto; text-align: left; font-size: 0.85rem; color: #333; line-height: 1.6; padding: 10px; background: #f9f9f9; border-radius: 8px; margin-top: 15px; }

        #dropOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10000; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); border: 4px dashed var(--primary); display: none; justify-content: center; align-items: center; pointer-events: none; transition: opacity 0.3s; }
        #dropOverlay.active { display: flex; }
        #dropOverlay::after { content: 'ì´ë¯¸ì§€ë¥¼ ì´ê³³ì— ë†“ìœ¼ì„¸ìš”'; color: var(--primary); font-size: 1.8rem; font-weight: 800; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="container" id="mainContainer">
    <div id="dropOverlay"></div> 
    
    <div class="header-wrap">
        <h1>Animo Pixel Master</h1>
    </div>

    <p class="sub-text" data-i18n="sub">í™”ì§ˆ ì €í•˜ ì—†ëŠ” ì œë¯¸ë‚˜ì´ ì›Œí„°ë§ˆí¬ ì œê±°<br>ê³ ì„±ëŠ¥ ì´ë¯¸ì§€ ë¶„í• ê³¼ ì´ë¯¸ì§€ ì••ì¶•</p>

    <div class="dashboard-layout">
        
        <div class="workspace-left">
            <div class="preview-top-bar">
                <div class="counter-box">
                    <span data-i18n="visitors">Today's Visitors</span>
                    <b id="cntVisit">0</b>
                </div>
                <div class="lang-wrapper">
                    <img id="currentFlag" src="https://flagcdn.com/24x18/kr.png" alt="KR" class="flag-icon">
                    <select class="lang-select" onchange="changeLanguage(this.value)">
                        <option value="ko">KO</option>
                        <option value="en">EN</option>
                        <option value="cn">CN</option>
                        <option value="jp">JP</option>
                    </select>
                </div>
            </div>

            <div id="previewContainer">
                <div id="guideText">
                    <div class="main-guide" data-i18n="guide_m">ì´ë¯¸ì§€ë¥¼ ì´ê³³ì— ë“œë˜ê·¸ í•˜ê±°ë‚˜<br>+ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
                    <div class="sub-guide">
                        <span data-i18n="guide_s">ì›Œí„°ë§ˆí¬ ì‚­ì œëŠ” ì œë¯¸ë‚˜ì´ë§Œ ì§€ì›í•©ë‹ˆë‹¤.<br>ìë™ ì €ì¥ ì²´í¬ì‹œ ë“œë˜ê·¸ë§Œìœ¼ë¡œ ìë™ ì €ì¥ë©ë‹ˆë‹¤.</span>
                        <div id="mobileGuide" style="color:#00e676; font-weight:bold; margin-top:8px;"></div>
                    </div>
                </div>
                <canvas id="previewCanvas" style="display:none;" 
                    onmousedown="handleStart(event)" onmousemove="handleMove(event)" onmouseup="handleEnd()" onmouseleave="handleEnd()"
                    ontouchstart="handleStart(event)" ontouchmove="handleMove(event)" ontouchend="handleEnd()">
                </canvas>
            </div>
        </div>

        <div class="workspace-right">
            
            <div class="pc-tab-menu tab-menu">
                <button class="tab-btn active" id="pcTabSplit" onclick="switchTab('split')">
                    <span data-i18n="tab_split">ì´ë¯¸ì§€ ë¶„í• </span>
                </button>
                <button class="tab-btn" id="pcTabCrop" onclick="switchTab('crop')">
                    <span data-i18n="tab_crop">ì´ë¯¸ì§€ ì••ì¶•</span>
                </button>
                <div class="tab-spacer" style="display:none;"></div>
            </div>

            <div class="tab-menu" style="display:none;"> 
                <button class="tab-btn active" id="mobTabSplit" onclick="switchTab('split')">
                    <span data-i18n="tab_split">ì´ë¯¸ì§€ ë¶„í• </span>
                </button>
                <button class="tab-btn" id="mobTabCrop" onclick="switchTab('crop')">
                    <span data-i18n="tab_crop">ì´ë¯¸ì§€ ì••ì¶•</span>
                </button>
            </div>

            <div class="pc-controls-wrapper">
                <div class="btn-group-vertical">
                    <label for="fileInput" class="tab-attach">+</label>
                    <div class="tab-delete" onclick="clearFiles()">Del</div>
                </div>

                <div class="chk-group-vertical top-options">
                    <label class="chk-label"><input type="checkbox" id="wmCheck"><span data-i18n="wm">ì›Œí„°ë§ˆí¬ ì œê±°</span></label>
                    <label class="chk-label"><input type="checkbox" id="autoCheck"><span data-i18n="auto">ìë™ ì €ì¥</span></label>
                    <label class="chk-label" style="display:none;"><input type="checkbox" id="freeCheck" onchange="toggleFreeMode()"><span data-i18n="free">ì§ì ‘ ì¡°ì ˆ</span></label>
                </div>
            </div>

            <div id="splitPanel" class="config-grid" style="grid-template-columns: repeat(3, 1fr);">
                <div class="input-group"><label data-i18n="row">ê°€ë¡œ ì¹¸</label><input type="number" id="rowInput" class="input-num" value="1" min="1" oninput="resetGridPositions()"></div>
                <div class="input-group"><label data-i18n="col">ì„¸ë¡œ ì¹¸</label><input type="number" id="colInput" class="input-num" value="1" min="1" oninput="resetGridPositions()"></div>
                <div class="input-group">
                    <label data-i18n="border">í…Œë‘ë¦¬(%)</label>
                    <div class="input-wrapper">
                        <input type="number" id="cropInput" class="input-num" value="0.5" step="0.1" oninput="drawVisualizer()">
                        </div>
                </div>
                
                <div class="input-group" style="grid-column: 1 / -1;">
                    <label data-i18n="cut_ratio">ì´ë¯¸ì§€ í¬ê¸°</label>
                    <div class="ratio-select-wrapper">
                        <select id="ratioSelectSplit" class="ratio-select" onchange="handleRatioSelect(this, 'split')">
                            <option value="full" data-i18n="full">ì›ë³¸ (ììœ  ë³€í˜•)</option>
                            <option value="1.777">16:9</option>
                            <option value="0.5625">9:16</option>
                            <option value="1">1:1</option>
                            <option value="custom" data-i18n="custom">ì§ì ‘ ì…ë ¥</option>
                        </select>
                    </div>
                    <div id="customRatioInputSplit" class="ratio-inputs-row" style="display:none;">
                        <input type="number" id="ratioWSplit" class="input-num" value="1" oninput="setRatioFromInput('split')">
                        <input type="number" id="ratioHSplit" class="input-num" value="1" oninput="setRatioFromInput('split')">
                    </div>
                </div>
            </div>

            <div id="cropPanel" class="config-grid" style="display: none;">
                 <div class="input-group" style="grid-column: 1 / -1;">
                    <label data-i18n="target_cap">ì••ì¶• ìš©ëŸ‰</label>
                    <div class="preset-btns">
                        <button class="preset-btn" id="p500" onclick="setTargetMB(0.5, this)"><span data-i18n="p500">500KB ì´í•˜</span></button>
                        <button class="preset-btn" id="p1" onclick="setTargetMB(1.0, this)"><span data-i18n="p1">1MB ì´í•˜</span></button>
                        <button class="preset-btn" id="p2" onclick="setTargetMB(2.0, this)"><span data-i18n="p2">2MB ì´í•˜</span></button>
                        <button class="preset-btn active" id="p5" onclick="setTargetMB(5.0, this)"><span data-i18n="p5">5MB ì´í•˜</span></button>
                    </div>
                </div>

                 <div class="input-group" style="grid-column: 1 / -1;">
                    <label data-i18n="cut_ratio">ì´ë¯¸ì§€ í¬ê¸°</label>
                    <div class="ratio-select-wrapper">
                        <select id="ratioSelect" class="ratio-select" onchange="handleRatioSelect(this, 'crop')">
                            <option value="full" data-i18n="full">ì›ë³¸ (ììœ  ë³€í˜•)</option>
                            <option value="1.777">16:9</option>
                            <option value="0.5625">9:16</option>
                            <option value="1">1:1</option>
                            <option value="custom" data-i18n="custom">ì§ì ‘ ì…ë ¥</option>
                        </select>
                    </div>
                    <div id="customRatioInput" class="ratio-inputs-row" style="display:none;">
                        <input type="number" id="ratioW" class="input-num" value="1" oninput="setRatioFromInput('crop')">
                        <input type="number" id="ratioH" class="input-num" value="1" oninput="setRatioFromInput('crop')">
                    </div>
                </div>
            </div>

            <div class="action-row">
                <button class="main-btn" id="downloadBtn" onclick="executeAction()" data-i18n="down">ë‹¤ìš´ë¡œë“œ</button>
                <div class="donation-btn" onclick="handleDonation()">
                    <span data-i18n="donate_text">ë„ì›€ì´ ë˜ì…¨ë‹¤ë©´<br>ì•„ë©”ë¦¬ì¹´ë…¸ í•œ ì” â˜•</span>
                </div>
            </div>
        </div>
    </div>

    <input type="file" id="fileInput" multiple accept="image/jpeg,image/png,image/webp,image/gif,image/*" style="display:none;" onchange="handleFiles(this.files)">
</div>

<div class="features-grid">
    <div class="feature-card"><div class="feat-icon bg-fast">âš¡</div><div class="feat-title">Lightning Fast</div><div class="feat-desc">ë¸Œë¼ìš°ì € ì—”ì§„ ê¸°ë°˜ì˜ ë°€ë¦¬ì´ˆ ë‹¨ìœ„ ì²˜ë¦¬ë¡œ ëŒ€ê¸° ì‹œê°„ ì—†ëŠ” ì¦‰ê°ì ì¸ ê²°ê³¼ë¬¼ì„ ì œê³µí•©ë‹ˆë‹¤.</div></div>
    <div class="feature-card"><div class="feat-icon bg-priv">ğŸ”’</div><div class="feat-title">Privacy First</div><div class="feat-desc">100% í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ í”„ë¡œì„¸ì‹±. ì´ë¯¸ì§€ëŠ” ì ˆëŒ€ ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•Šìœ¼ë©° ê¸°ê¸° ë‚´ì—ì„œë§Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.</div></div>
    <div class="feature-card"><div class="feat-icon bg-free">ğŸ’</div><div class="feat-title">Completely Free</div><div class="feat-desc">ì‚¬ìš© ì œí•œì´ë‚˜ ìˆ¨ê²¨ì§„ ë¹„ìš© ì—†ì´ ëª¨ë“  ê°•ë ¥í•œ ê¸°ëŠ¥ë“¤ì„ ì–¸ì œ ì–´ë””ì„œë‚˜ ì¦‰ì‹œ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div></div>
</div>

<div class="gemini-section">
    <div class="gemini-title">âœ¨ Gemini Gems Prompt: 3ë¶„í•  ë ˆì´ì•„ì›ƒ ìƒì„±ê¸°</div>
    <div class="gemini-grid">
        <button class="gem-btn" onclick="showPrompt('stack')">
            <span class="icon">ğŸš¥</span>
            <span>ê°€ë¡œ 16:9 3ì¥<br>(ìˆ˜ì§ ë‚˜ì—´í˜•)</span>
        </button>
        <button class="gem-btn" onclick="showPrompt('side')">
            <span class="icon">ğŸ–¼ï¸</span>
            <span>ì„¸ë¡œ 9:16 3ì¥<br>(ê°€ë¡œ ë‚˜ì—´í˜•)</span>
        </button>
    </div>
    <div class="gem-tip-box">
        <strong>ğŸ’¡ ë©€í‹° í”„ë ˆì„ ìƒì„±ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ êµ¬ì¡°í™” ì „ëµ</strong>
        ìµœì ì˜ ê²°ê³¼ë¬¼ì„ ì–»ìœ¼ë ¤ë©´, 3ê°œì˜ í”„ë¡¬í”„íŠ¸ë¥¼ <u>ì¤„ë°”ê¿ˆ(Line Break)ìœ¼ë¡œ êµ¬ë¶„</u>í•˜ì—¬ ì…ë ¥í•˜ê±°ë‚˜, ë‹¨ì¼ í”„ë¡¬í”„íŠ¸ ëì— <u>'3-panel layout' ë˜ëŠ” 'Triptych style'</u> í‚¤ì›Œë“œë¥¼ ë³‘ê¸°í•˜ëŠ” ê²ƒì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.
    </div>
</div>

<div class="info-container">
    <div class="info-section">
        <div class="info-title">ğŸš€ Development Story: ì™œ ë§Œë“¤ì—ˆë‚˜ìš”?</div>
        <div class="info-text">
            ì œë¯¸ë‚˜ì´(Gemini)ì˜ ì´ë¯¸ì§€ ìƒì„± ëŠ¥ë ¥ì€ ì••ë„ì ì´ì§€ë§Œ, í•œ ë²ˆì— í•œ ì¥ì”© ë½‘ìœ¼ë ¤ë©´ ëŒ€ê¸° ì‹œê°„ì´ ê¸¸ì–´ì§€ê³¤ í•©ë‹ˆë‹¤. 
            ì €ëŠ” ì—¬ê¸°ì„œ <strong>'í•˜ë‚˜ì˜ ë ˆì´ì•„ì›ƒì— ì—¬ëŸ¬ í”„ë¡¬í”„íŠ¸ë¥¼ ë„£ì–´ ë‹¤ìˆ˜ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ìƒì„±í•˜ëŠ” íŒ'</strong>ì„ í™œìš©í•´ ìƒì‚°ì„±ì„ ê·¹ëŒ€í™”í•´ ì™”ìŠµë‹ˆë‹¤.
        </div>
        <div class="info-text">
            í•˜ì§€ë§Œ ì´ë ‡ê²Œ ìƒì„±ëœ ê²°ê³¼ë¬¼ì„ ì¼ì¼ì´ ì›Œí„°ë§ˆí¬ë¥¼ ì§€ìš°ê³  ìˆ˜ë™ìœ¼ë¡œ ìë¥´ëŠ” ì‘ì—…ì€ ë§¤ìš° ë²ˆê±°ë¡œì› ìŠµë‹ˆë‹¤. 
            ê·¸ë˜ì„œ <strong>ì›Œí„°ë§ˆí¬ ì œê±°ì™€ ì´ë¯¸ì§€ ë¶„í• ì„ ë‹¨ í•œ ë²ˆì˜ ë“œë˜ê·¸ë¡œ ìë™í™”</strong>í•  ìˆ˜ ìˆëŠ” ë„êµ¬ë¥¼ ì§ì ‘ ê°œë°œí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. 
            ì´ë¯¸ì§€ ìµœì í™”ê°€ í•„ìš”í•œ ëª¨ë“  ì œë¯¸ë‚˜ì´ ì‚¬ìš©ìë“¤ì´ ì €ì²˜ëŸ¼ ì°½ì‘ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆê¸°ë¥¼ ë°”ëë‹ˆë‹¤.
        </div>
    </div>
    <div class="info-section">
        <div class="info-title">âœ¨ Animo Pixel Masterì˜ íŠ¹ì§•</div>
        <ul class="feature-list">
            <li><strong>ê°•ë ¥í•œ ë³´ì•ˆ:</strong> ëª¨ë“  ì´ë¯¸ì§€ ì²˜ë¦¬ëŠ” ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €(Client-side)ì—ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ê°œì¸ì •ë³´ ìœ ì¶œ ê±±ì •ì´ ì—†ìŠµë‹ˆë‹¤.</li>
            <li><strong>ìŠ¤ë§ˆíŠ¸ ìš©ëŸ‰ ì••ì¶•:</strong> ì´ì§„ íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ì´ íŠ¹ì • ìš©ëŸ‰(ì˜ˆ: 5MB)ì— ë§ì¶° ìµœì ì˜ í™”ì§ˆì„ ìë™ìœ¼ë¡œ ì°¾ì•„ ì••ì¶•í•©ë‹ˆë‹¤.</li>
            <li><strong>ì¸ìŠ¤íƒ€ê·¸ë¨ ìµœì í™”:</strong> ê°€ë¡œ/ì„¸ë¡œ ì¹¸ ìˆ˜ë§Œ ì…ë ¥í•˜ë©´ í”¼ë“œì— ë”± ë§ëŠ” ê·¸ë¦¬ë“œ ì´ë¯¸ì§€ë¡œ ì¦‰ì‹œ ë¶„í•  ì €ì¥ë©ë‹ˆë‹¤.</li>
        </ul>
    </div>

    <div class="info-section">
        <div class="info-title">ğŸ’¡ ì‚¬ìš© ê°€ì´ë“œ (FAQ)</div>
        <div class="info-text">
            <strong>Q. ì œë¯¸ë‚˜ì´ ì›Œí„°ë§ˆí¬ëŠ” ì–´ë–»ê²Œ ì§€ìš°ë‚˜ìš”?</strong><br>
            ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¨ í›„ ìƒë‹¨ì˜ [ì›Œí„°ë§ˆí¬ ì œê±°]ë¥¼ ì²´í¬í•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”. AIê°€ ìƒì„±í•œ íŠ¹ì • íŒ¨í„´ì„ ì¸ì‹í•´ í”½ì…€ ë‹¨ìœ„ë¡œ ë³µì›í•©ë‹ˆë‹¤.
        </div>
        <div class="info-text">
            <strong>Q. ëª¨ë°”ì¼ì—ì„œë„ ê°€ëŠ¥í•œê°€ìš”?</strong><br>
            ë„¤, ë°˜ì‘í˜• ë””ìì¸ìœ¼ë¡œ ìŠ¤ë§ˆíŠ¸í°ì—ì„œë„ 100% í™œìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë³´ì•ˆ ì •ì±…ìƒ ëª¨ë°”ì¼ì—ì„œëŠ” í•œ ì¥ì”© ìˆœì°¨ì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤.
        </div>
    </div>

    <div class="footer-links">
        <span onclick="openPolicy('privacy')">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span> | 
        <span onclick="openPolicy('terms')">ì´ìš©ì•½ê´€</span> | 
        <span>Copyright Â© 2026 Animo. All rights reserved.</span>
    </div>
</div>

<div id="promptModal" class="qr-modal">
    <div class="qr-box" style="max-width: 500px; background: #1e1e1e; color: white;">
        <h3 id="promptTitle" style="color: var(--gem-accent);">í”„ë¡¬í”„íŠ¸ ì•ˆë‚´</h3>
        <p style="font-size: 0.8rem; color: #888; margin-top: -10px;">ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì œë¯¸ë‚˜ì´ Gems ì„¤ì •ì´ë‚˜ ëŒ€í™”ì°½ì— ë³µì‚¬í•´ ë„£ìœ¼ì„¸ìš”.</p>
        <div class="prompt-view" id="promptText"></div>
        <button class="copy-btn" id="btnCopyPrompt" onclick="copyPrompt()">í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°</button>
        <button class="close-qr" onclick="closePrompt()" style="background: #333;">ë‹«ê¸°</button>
    </div>
</div>

<div id="qrModal" class="qr-modal">
    <div class="qr-box">
        <h3>â˜• ì¹´ë©”ë¼ë¡œ ìŠ¤ìº”í•´ì£¼ì„¸ìš”</h3>
        <img src="https://github.com/two5220/assets/blob/main/kakao_qr.png?raw=true" alt="KakaoPay QR" class="qr-img">
        <button class="close-qr" onclick="closeQr()">ë‹«ê¸°</button>
    </div>
</div>

<div id="policyModal" class="qr-modal">
    <div class="qr-box" style="max-width: 500px;">
        <h3 id="policyTitle">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</h3>
        <div class="policy-content" id="policyText"></div>
        <button class="close-qr" onclick="closePolicy()">ë‹«ê¸°</button>
    </div>
</div>

<script>
    const FIX_X = 64, FIX_Y = 64, MASK_URL = "https://raw.githubusercontent.com/two5220/assets/refs/heads/main/mask.png";
    let maskImg = new Image(), maskData = null, maskW = 0, maskH = 0, previewImg = null, originalFile = null;
    let currentTab = 'split', colPos = [], rowPos = [], gridBox = { x1: 0, y1: 0, x2: 1, y2: 1 }, cropBox = { x: 0, y: 0, w: 1, h: 1 };
    let fixedRatio = 'full', currentTargetMB = 5.0, currentLang = 'ko';
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    let mobileSplitIdx = 0; 
    const MAX_MOBILE_SPLIT = 50; 

    /* [í”„ë¡¬í”„íŠ¸ ë°ì´í„° ë³µêµ¬] */
    const prompts = {
        stack: `ì—­í•  ë° ëª©í‘œ:
* ì‚¬ìš©ìê°€ ì œê³µí•œ íŠ¹ì • ì£¼ì œë‚˜ 3ê°€ì§€ ê°œë³„ í”„ë¡¬í”„íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì ˆëŒ€ì  16:9 ê°€ë¡œ ë¹„ìœ¨ì˜ ì´ë¯¸ì§€ 3ì¥ì„ ìˆ˜ì§ìœ¼ë¡œ ë‚˜ì—´í•œ ë‹¨ì¼ ë ˆì´ì•„ì›ƒ ì´ë¯¸ì§€ë¥¼ ê¸°íší•˜ê³  ìƒì„±í•œë‹¤.
* ê° ì˜ì—­(1êµ¬ì—­, 2êµ¬ì—­, 3êµ¬ì—­)ì— ëŒ€í•´ ì¼ê´€ì„± ìˆëŠ” ìŠ¤íƒ€ì¼ì´ë‚˜ ì§€ì‹œëœ ê°œë³„ ë‚´ìš©ì„ ì¶©ì‹¤íˆ ë°˜ì˜í•œë‹¤.
* í•˜ë‚˜ì˜ ì˜ì—­ì˜ ì´ë¯¸ì§€ëŠ” ë‹¤ë¥¸ ë ˆì´ì•„ì›ƒ ì˜ì—­ì„ ì¹¨ë²”í•˜ì§€ ì•Šë„ë¡ ì—„ê²©íˆ êµ¬ë¶„í•˜ë©°, ì´ë¯¸ì§€ êµ¬ë¶„ ê²½ê³„ì„ ì´ë‚˜ ë°”ê¹¥ í…Œë‘ë¦¬ê°€ ì—†ëŠ” ë§¤ë„ëŸ¬ìš´ ì—°ê²°ì„ ì§€í–¥í•©ë‹ˆë‹¤.
* ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ í¬ë¡­í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ìƒì„±ê°€ëŠ¥í•œ ìµœê³ í•´ìƒë„ë¡œ ì œê³µí•œë‹¤.`,
        side: `ëª©ì  ë° ëª©í‘œ:
* ì‚¬ìš©ìê°€ ì œê³µí•œ ì£¼ì œë‚˜ 3ê°œì˜ í”„ë¡¬í”„íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì„¸ë¡œ ë¹„ìœ¨(9:16) ì´ë¯¸ì§€ 3ì¥ì´ ê°€ë¡œë¡œ ë‚˜ë€íˆ ë°°ì¹˜ëœ ë‹¨ì¼ ì´ë¯¸ì§€ ë ˆì´ì•„ì›ƒ(16:9 ê°€ë¡œí˜•)ì„ êµ¬ì„±í•˜ëŠ” 'ì„¸ë¡œ ë¹„ìœ¨ 3ì¥ ë ˆì´ì•„ì›ƒ' ì „ë¬¸ê°€ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
* ë‹¨ì¼ ì£¼ì œê°€ ì£¼ì–´ì§€ë©´ ê·¸ì— ë§ëŠ” 3ê°€ì§€ ì¥ë©´ì„ ìŠ¤ìŠ¤ë¡œ êµ¬ìƒí•˜ì—¬ ì¼ê´€ì„± ìˆëŠ” ë ˆì´ì•„ì›ƒì„ ë§Œë“­ë‹ˆë‹¤.
* 3ê°œì˜ ê°œë³„ í”„ë¡¬í”„íŠ¸ê°€ ì£¼ì–´ì§€ë©´ ê° í”„ë¡¬í”„íŠ¸ì˜ ë‚´ìš©ì„ ì¶©ì‹¤íˆ ë°˜ì˜í•˜ì—¬ 3ë¶„í•  ë ˆì´ì•„ì›ƒì— í‘œí˜„í•©ë‹ˆë‹¤.`
    };

    function showPrompt(type) {
        const title = type === 'stack' ? 'ê°€ë¡œ 16:9 (ìˆ˜ì§ 3ë‹¨) í”„ë¡¬í”„íŠ¸' : 'ì„¸ë¡œ 9:16 (ê°€ë¡œ 3ì—´) í”„ë¡¬í”„íŠ¸';
        document.getElementById('promptTitle').innerText = title;
        document.getElementById('promptText').innerText = prompts[type];
        document.getElementById('promptModal').classList.add('active');
        document.getElementById('btnCopyPrompt').innerText = 'í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°';
    }

    function closePrompt() { document.getElementById('promptModal').classList.remove('active'); }

    function copyPrompt() {
        const text = document.getElementById('promptText').innerText;
        navigator.clipboard.writeText(text).then(() => {
            document.getElementById('btnCopyPrompt').innerText = 'âœ… ë³µì‚¬ ì™„ë£Œ!';
            setTimeout(() => { document.getElementById('btnCopyPrompt').innerText = 'í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°'; }, 2000);
        });
    }

    function updateMobileGuide() { if (!isMobile) return; const guide = document.getElementById('mobileGuide'); if (guide) guide.innerHTML = t[currentLang].guide_mobile; }
    const KAKAO_LINK = "https://qr.kakaopay.com/Ej8NXO17Z";
    function handleDonation() { if (isMobile) { window.open(KAKAO_LINK, '_blank'); } else { document.getElementById('qrModal').classList.add('active'); } }
    function closeQr() { document.getElementById('qrModal').classList.remove('active'); }
    
    const flags = { ko: 'kr', en: 'us', cn: 'cn', jp: 'jp', in: 'in' };
    const t = {
        ko: { 
            tab_split: "ì´ë¯¸ì§€<br class='pc-br'>ë¶„í• ", tab_crop: "ì´ë¯¸ì§€<br class='pc-br'>ì••ì¶•", visitors: "Today's Visitors", wm: "ì›Œí„°ë§ˆí¬ ì œê±°", auto: "ìë™ ì €ì¥", free: "ì§ì ‘ ì¡°ì ˆ", 
            row: "ê°€ë¡œ ì¹¸", col: "ì„¸ë¡œ ì¹¸", border: "í…Œë‘ë¦¬(%)", cut_ratio: "ì´ë¯¸ì§€ í¬ê¸°", target_cap: "ì••ì¶• ìš©ëŸ‰", 
            p500: "500KB ì´í•˜", p1: "1MB ì´í•˜", p2: "2MB ì´í•˜", p5: "5MB ì´í•˜", full: "ì›ë³¸ (ììœ  ë³€í˜•)", custom: "ì§ì ‘ ì…ë ¥",
            down: "ë‹¤ìš´ë¡œë“œ", sub: "í™”ì§ˆ ì €í•˜ ì—†ëŠ” ì œë¯¸ë‚˜ì´ ì›Œí„°ë§ˆí¬ ì œê±°<br>ê³ ì„±ëŠ¥ ì´ë¯¸ì§€ ë¶„í• ê³¼ ì´ë¯¸ì§€ ì••ì¶•", 
            guide_m: "ì´ë¯¸ì§€ë¥¼ ì´ê³³ì— ë“œë˜ê·¸ í•˜ê±°ë‚˜<br>+ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”", guide_s: "ì›Œí„°ë§ˆí¬ ì‚­ì œëŠ” ì œë¯¸ë‚˜ì´ë§Œ ì§€ì›í•©ë‹ˆë‹¤.<br>ìë™ ì €ì¥ ì²´í¬ì‹œ ë“œë˜ê·¸ë§Œìœ¼ë¡œ ìë™ ì €ì¥ë©ë‹ˆë‹¤.",
            guide_mobile: "ëª¨ë°”ì¼ì€ ë³´ì•ˆ ì •ì±…ìƒ ë²ˆí˜¸ìˆœìœ¼ë¡œ<br>í•œ ì¥ì”© ë‹¤ìš´ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤.",
            wait: "ì ì‹œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.", down_pair: "{n}ë²ˆ ë‹¤ìš´ë¡œë“œ", down_done_pair: "ì™„ë£Œ! {n}ë²ˆ ë‹¤ìš´ë¡œë“œ", all_done: "ì „ì²´ ì™„ë£Œ (ë‹¤ì‹œ ì‹œì‘)",
            donate_text: "ë„ì›€ì´ ë˜ì…¨ë‹¤ë©´<br>ì•„ë©”ë¦¬ì¹´ë…¸ í•œ ì” â˜•"
        },
        en: { 
            tab_split: "Image<br class='pc-br'>Split", tab_crop: "Image<br class='pc-br'>Compress", visitors: "Today's Visitors", wm: "Remove Watermark", auto: "Auto Save", free: "Manual Adjust", 
            row: "Horizontal Rows", col: "Vertical Cols", border: "Border(%)", cut_ratio: "Image Ratio", target_cap: "Compression", 
            p500: "Under 500KB", p1: "Under 1MB", p2: "Under 2MB", p5: "Under 5MB", full: "Original (Free)", custom: "Custom Input",
            down: "Download", sub: "Lossless Gemini Watermark Removal<br>High Performance Split & Compress", 
            guide_m: "Drag images here or<br>click the + button", guide_s: "Watermark removal supports Gemini only.<br>Auto-save on drag when 'Auto Save' is checked.",
            guide_mobile: "Due to security policy on mobile,<br>please download sequentially.",
            wait: "Please wait.", down_pair: "{n} Download", down_done_pair: "Done! {n} Download", all_done: "All Done (Restart)",
            donate_text: "If this helped,<br>Buy me an Americano â˜•"
        },
        jp: {
            tab_split: "ç”»åƒ<br class='pc-br'>åˆ†å‰²", tab_crop: "ç”»åƒ<br class='pc-br'>åœ§ç¸®", visitors: "ä»Šæ—¥ã®è¨ªå•è€…", wm: "é€ã‹ã—å‰Šé™¤", auto: "è‡ªå‹•ä¿å­˜", free: "æ‰‹å‹•è¨­å®š", 
            row: "æ¨ªã®åˆ†å‰²æ•°", col: "ç¸¦ã®åˆ†å‰²æ•°", border: "ä½™ç™½(%)", cut_ratio: "ç”»åƒæ¯”ç‡", target_cap: "åœ§ç¸®å®¹é‡", 
            p500: "500KBä»¥ä¸‹", p1: "1MBä»¥ä¸‹", p2: "2MBä»¥ä¸‹", p5: "5MBä»¥ä¸‹", full: "å…ƒç”»åƒ (è‡ªç”±)", custom: "æ‰‹å‹•å…¥åŠ›",
            down: "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰", sub: "ç”»è³ªåŠ£åŒ–ãªã—ï¼Geminié€ã‹ã—å‰Šé™¤<br>é«˜æ€§èƒ½ãªç”»åƒåˆ†å‰²ï¼†åœ§ç¸®ãƒ„ãƒ¼ãƒ«", 
            guide_m: "ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°ã™ã‚‹ã‹<br>ï¼‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„", guide_s: "é€ã‹ã—å‰Šé™¤ã¯Geminiç”Ÿæˆç”»åƒã®ã¿å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚",
            guide_mobile: "ãƒ¢ãƒã‚¤ãƒ«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã®ãŸã‚ã€<br>é †ç•ªã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚",
            wait: "ãŠå¾…ã¡ãã ã•ã„ã€‚", down_pair: "{n} ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰", down_done_pair: "å®Œäº†ï¼ {n} ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰", all_done: "å®Œäº† (å†é–‹)",
            donate_text: "ãŠå½¹ã«ç«‹ã¦ã‚Œã°<br>ã‚³ãƒ¼ãƒ’ãƒ¼ä¸€æ¯ã‚’ â˜•"
        },
        in: {
            tab_split: "à¤‡à¤®à¥‡à¤œ<br class='pc-br'>à¤¸à¥à¤ªà¥à¤²à¤¿à¤Ÿ", tab_crop: "à¤‡à¤®à¥‡à¤œ<br class='pc-br'>à¤•à¤‚à¤ªà¥à¤°à¥‡à¤¸", visitors: "à¤†à¤œ à¤•à¥‡ à¤†à¤—à¤‚à¤¤à¥à¤•", wm: "à¤µà¥‰à¤Ÿà¤°à¤®à¤¾à¤°à¥à¤•", auto: "à¤‘à¤Ÿà¥‹ à¤¸à¥‡à¤µ", free: "à¤®à¥ˆà¤¨à¥à¤…à¤² à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—", 
            row: "à¤•à¥à¤·à¥ˆà¤¤à¤¿à¤œ à¤ªà¤‚à¤•à¥à¤¤à¤¿à¤¯à¤¾à¤", col: "à¤²à¤‚à¤¬à¤µà¤¤ à¤•à¥‰à¤²à¤®", border: "à¤¬à¥‰à¤°à¥à¤¡à¤°(%)", cut_ratio: "à¤‡à¤®à¥‡à¤œ à¤…à¤¨à¥à¤ªà¤¾à¤¤", target_cap: "à¤¸à¤‚à¤ªà¥€à¤¡à¤¼à¤¨", 
            p500: "500KB à¤¸à¥‡ à¤•à¤®", p1: "1MB à¤¸à¥‡ à¤•à¤®", p2: "2MB à¤¸à¥‡ à¤•à¤®", p5: "5MB à¤¸à¥‡ à¤•à¤®", full: "à¤®à¥‚à¤² (à¤¨à¤¿à¤ƒà¤¶à¥à¤²à¥à¤•)", custom: "à¤®à¥ˆà¤¨à¥à¤…à¤²",
            down: "à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡", sub: "à¤¬à¤¿à¤¨à¤¾ à¤•à¥à¤µà¤¾à¤²à¤¿à¤Ÿà¥€ à¤–à¥‹à¤ à¤œà¥‡à¤®à¤¿à¤¨à¥€ à¤µà¥‰à¤Ÿà¤°à¤®à¤¾à¤°à¥à¤• à¤¹à¤Ÿà¤¾à¤à¤‚<br>à¤¹à¤¾à¤ˆ-à¤¸à¥à¤ªà¥€à¤¡ à¤‡à¤®à¥‡à¤œ à¤µà¤¿à¤­à¤¾à¤œà¤¨ à¤”à¤° à¤¸à¤‚à¤ªà¥€à¤¡à¤¼à¤¨", 
            guide_m: "à¤‡à¤®à¥‡à¤œ à¤¯à¤¹à¤¾à¤ à¤–à¥€à¤‚à¤šà¥‡à¤‚ à¤¯à¤¾<br>+ à¤¬à¤Ÿà¤¨ à¤¦à¤¬à¤¾à¤à¤‚", guide_s: "à¤µà¥‰à¤Ÿà¤°à¤®à¤¾à¤°à¥à¤• à¤¹à¤Ÿà¤¾à¤¨à¤¾ à¤•à¥‡à¤µà¤² à¤œà¥‡à¤®à¤¿à¤¨à¥€ à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¤®à¤°à¥à¤¥à¤¿à¤¤ à¤¹à¥ˆà¥¤",
            guide_mobile: "à¤®à¥‹à¤¬à¤¾à¤‡à¤² à¤¸à¥à¤°à¤•à¥à¤·à¤¾ à¤¨à¥€à¤¤à¤¿ à¤•à¥‡ à¤•à¤¾à¤°à¤£,<br>à¤•à¥ƒà¤ªà¤¯à¤¾ à¤•à¥à¤°à¤®à¤¿à¤• à¤°à¥‚à¤ª à¤¸à¥‡ à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚à¥¤",
            wait: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾ à¤•à¤°à¥‡à¤‚à¥¤", down_pair: "{n} à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡", down_done_pair: "à¤¹à¥‹ à¤—à¤¯à¤¾! {n} à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡", all_done: "à¤¸à¤­à¥€ à¤¹à¥‹ à¤—à¤¯à¤¾ (à¤ªà¥à¤¨à¤ƒ à¤†à¤°à¤‚à¤­ à¤•à¤°à¥‡à¤‚)",
            donate_text: "à¤¯à¤¦à¤¿ à¤®à¤¦à¤¦ à¤®à¤¿à¤²à¥€,<br>à¤•à¥‰à¤«à¥€ à¤ªà¤¿à¤²à¤¾à¤à¤‚ â˜•"
        }
    };
    function changeLanguage(lang) { 
        currentLang = lang; 
        document.querySelectorAll('[data-i18n]').forEach(el => { 
            const key = el.getAttribute('data-i18n'); 
            if(t[lang][key]) el.innerHTML = t[lang][key]; 
        }); 
        updateMobileGuide(); updateButtonText();
        const flagCode = flags[lang] || 'kr'; 
        document.getElementById('currentFlag').src = `https://flagcdn.com/24x18/${flagCode}.png`; 
    }
    window.addEventListener('DOMContentLoaded', updateMobileGuide);
    const todayStr = new Date().toISOString().slice(0, 10);
    const savedDate = localStorage.getItem('animo_date');
    let visitCnt = parseInt(localStorage.getItem('animo_visit') || '0');
    if (savedDate !== todayStr) { visitCnt = 0; localStorage.setItem('animo_date', todayStr); }
    if (!sessionStorage.getItem('session_active')) { visitCnt++; localStorage.setItem('animo_visit', visitCnt); sessionStorage.setItem('session_active', 'true'); }
    document.getElementById('cntVisit').innerText = visitCnt;
    const mainCont = document.getElementById('mainContainer');
    window.addEventListener('dragenter', (e) => { e.preventDefault(); document.getElementById('dropOverlay').classList.add('active'); });
    window.addEventListener('dragover', (e) => { e.preventDefault(); });
    mainCont.addEventListener('dragleave', (e) => { if (e.relatedTarget === null || !mainCont.contains(e.relatedTarget)) document.getElementById('dropOverlay').classList.remove('active'); });
    window.addEventListener('drop', (e) => { e.preventDefault(); document.getElementById('dropOverlay').classList.remove('active'); if (e.dataTransfer.files.length > 0) handleFiles(e.dataTransfer.files); });
    maskImg.crossOrigin = "Anonymous";
    maskImg.onload = () => { const c = document.createElement('canvas'); c.width = maskImg.width; c.height = maskImg.height; const ctx = c.getContext('2d'); ctx.drawImage(maskImg, 0, 0); const d = ctx.getImageData(0,0,c.width,c.height).data; let minX = c.width, minY = c.height, maxX = 0, maxY = 0, found = false; for(let y=0; y<c.height; y++){ for(let x=0; x<c.width; x++){ if(d[(y*c.width+x)*4]>15){ minX=Math.min(minX,x); maxX=Math.max(maxX,x); minY=Math.min(minY,y); maxY=Math.max(maxY,y); } } } maskW=maxX-minX+1; maskH=maxY-minY+1; maskData=ctx.getImageData(minX, minY, maskW, maskH).data; };
    maskImg.src = MASK_URL;
    function setTargetMB(mb, btn) { currentTargetMB = mb; document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }
    
    function toggleFreeMode() { 
        const isFree = document.getElementById('freeCheck').checked; 
        const ratioInput = document.getElementById('ratioInputGroup');
        if(ratioInput) ratioInput.style.display = isFree ? 'flex' : 'none';
        if(currentTab === 'split') { if(!isFree) gridBox = { x1: 0, y1: 0, x2: 1, y2: 1 }; }
        resetGridPositions(); drawVisualizer(); 
    }

    function clearFiles() { previewImg = null; originalFile = null; mobileSplitIdx = 0; updateButtonText(); document.getElementById('previewCanvas').style.display = 'none'; document.getElementById('guideText').style.display = 'flex'; document.getElementById('fileInput').value = ''; }
    
    // [ìˆ˜ì •: ìŠ¤ìœ„ì¹˜íƒ­ í•¨ìˆ˜ - ID ì¶©ëŒ ë°©ì§€]
    function switchTab(tab) { 
        currentTab = tab; 
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); 
        
        // PC/Mobile ë²„íŠ¼ ëª¨ë‘ Active ì²˜ë¦¬
        if(tab === 'split') {
            if(document.getElementById('pcTabSplit')) document.getElementById('pcTabSplit').classList.add('active');
            if(document.getElementById('mobTabSplit')) document.getElementById('mobTabSplit').classList.add('active');
        } else {
            if(document.getElementById('pcTabCrop')) document.getElementById('pcTabCrop').classList.add('active');
            if(document.getElementById('mobTabCrop')) document.getElementById('mobTabCrop').classList.add('active');
        }

        document.getElementById('splitPanel').style.display = tab === 'split' ? 'grid' : 'none'; 
        document.getElementById('cropPanel').style.display = tab === 'crop' ? 'grid' : 'none'; 
        
        /* [íƒ­ ë³€ê²½ ì‹œ ì›ë³¸ ìë™ ì„ íƒ] */
        if(tab === 'crop') {
            document.getElementById('ratioSelect').value = 'full';
            handleRatioSelect(document.getElementById('ratioSelect'), 'crop');
        } else {
            // ë¶„í•  íƒ­ì—ì„œë„ ì´ˆê¸°í™”
            document.getElementById('ratioSelectSplit').value = 'full';
            handleRatioSelect(document.getElementById('ratioSelectSplit'), 'split');
        }

        updateButtonText(); drawVisualizer(); 
    }

    function updateButtonText() { const btn = document.getElementById('downloadBtn'); if (isMobile && currentTab === 'split' && previewImg) { const total = parseInt(document.getElementById('colInput').value) * parseInt(document.getElementById('rowInput').value); if (mobileSplitIdx >= total) btn.innerText = t[currentLang].all_done; else { const txt = (mobileSplitIdx === 0) ? t[currentLang].down_pair : t[currentLang].down_done_pair; btn.innerText = txt.replace('{n}', mobileSplitIdx + 1); } } else btn.innerText = t[currentLang].down; }
    
    /* [ë¹„ìœ¨ ì…€ë ‰íŠ¸ í•¸ë“¤ëŸ¬ (ë¶„í• /ì••ì¶• ê³µí†µ)] */
    function handleRatioSelect(elem, type) {
        const val = elem.value;
        const customInputId = type === 'split' ? 'customRatioInputSplit' : 'customRatioInput';
        const customInput = document.getElementById(customInputId);
        
        if (val === 'custom') {
            customInput.style.display = 'flex';
            setRatioFromInput(type);
        } else if (val === 'full') {
            customInput.style.display = 'none';
            setFixedRatio('full');
        } else {
            customInput.style.display = 'none';
            setFixedRatio(parseFloat(val));
        }
    }

    function setFixedRatio(mode) { 
        fixedRatio = mode; 
        if(mode === 'full') { cropBox = { x: 0, y: 0, w: 1, h: 1 }; } 
        drawVisualizer(); 
    }

    function setRatioFromInput(type) { 
        const wId = type === 'split' ? 'ratioWSplit' : 'ratioW';
        const hId = type === 'split' ? 'ratioHSplit' : 'ratioH';
        const w = parseFloat(document.getElementById(wId).value), h = parseFloat(document.getElementById(hId).value); 
        if(w > 0 && h > 0) { 
            fixedRatio = w / h; 
            adjustCropToRatio(); 
        } 
    }

    function adjustCropToRatio() { 
        if(!previewImg || !fixedRatio || fixedRatio === 'full') return; 
        let r = fixedRatio; 
        const imgRatio = previewImg.width / previewImg.height; 
        if(r > imgRatio) { cropBox.w = 0.9; cropBox.h = (0.9 * imgRatio) / r; } 
        else { cropBox.h = 0.9; cropBox.w = (0.9 * r) / imgRatio; } 
        cropBox.x = (1 - cropBox.w) / 2; cropBox.y = (1 - cropBox.h) / 2; 
        drawVisualizer(); 
    }

    function resetGridPositions() { const cols = parseInt(document.getElementById('colInput').value), rows = parseInt(document.getElementById('rowInput').value); if (cols * rows > MAX_MOBILE_SPLIT && isMobile) { alert(`ëª¨ë°”ì¼ ìµœëŒ€ ${MAX_MOBILE_SPLIT}ë¶„í•  ì§€ì›.`); document.getElementById('colInput').value = 1; document.getElementById('rowInput').value = 1; return; } colPos = []; rowPos = []; for(let i=1; i<cols; i++) colPos.push(i/cols); for(let i=1; i<rows; i++) rowPos.push(i/rows); mobileSplitIdx = 0; updateButtonText(); drawVisualizer(); }
    async function handleFiles(files) { const valid = Array.from(files).filter(f => f.type.startsWith('image/')); if(!valid.length) return; originalFile = valid[0]; const reader = new FileReader(); reader.onload = (e) => { previewImg = new Image(); previewImg.onload = async () => { document.getElementById('previewCanvas').style.display = 'block'; document.getElementById('guideText').style.display = 'none'; resetGridPositions(); if(document.getElementById('autoCheck').checked) { for(let file of valid.slice(0, 20)) await executeAction(file); } }; previewImg.src = e.target.result; }; reader.readAsDataURL(originalFile); }
    function drawVisualizer() { if(!previewImg) return; const canvas = document.getElementById('previewCanvas'), ctx = canvas.getContext('2d'); canvas.width = previewImg.naturalWidth; canvas.height = previewImg.naturalHeight; ctx.drawImage(previewImg, 0, 0); const cropP = parseFloat(document.getElementById('cropInput').value) / 100; if(currentTab === 'split') { const isFree = false; const x1 = gridBox.x1 * canvas.width, y1 = gridBox.y1 * canvas.height, x2 = gridBox.x2 * canvas.width, y2 = gridBox.y2 * canvas.height, gw = x2 - x1, gh = y2 - y1, fCols = [0, ...colPos, 1], fRows = [0, ...rowPos, 1]; if(isFree) { ctx.fillStyle = "rgba(0,0,0,0.5)"; ctx.fillRect(0,0,canvas.width, y1); ctx.fillRect(0,y2,canvas.width, canvas.height-y2); ctx.fillRect(0,y1,x1,y2-y1); ctx.fillRect(x2,y1,canvas.width-x2,y2-y1); const sz = canvas.width / 80; ctx.fillStyle = "#00e676"; ctx.fillRect(x1 - sz/2, y1 - sz/2, sz, sz); ctx.fillRect(x2 - sz/2, y1 - sz/2, sz, sz); ctx.fillRect(x1 - sz/2, y2 - sz/2, sz, sz); ctx.fillRect(x2 - sz/2, y2 - sz/2, sz, sz); } let cellNum = 1; for(let r=0; r < fRows.length - 1; r++) { for(let c=0; c < fCols.length - 1; c++) { const sx = x1 + fCols[c]*gw, sy = y1 + fRows[r]*gh, sw = (fCols[c+1]-fCols[c])*gw, sh = (fRows[r+1]-fRows[r])*gh; const mx = sw * cropP, my = sh * cropP; ctx.strokeStyle = "#00e676"; ctx.lineWidth = canvas.width / 110; ctx.strokeRect(sx + mx, sy + my, sw - mx*2, sh - my*2); const fs = Math.min(sw, sh) * 0.18; ctx.font = `bold ${fs}px Pretendard`; ctx.textAlign = "center"; ctx.textBaseline = "middle"; ctx.strokeStyle = "black"; ctx.lineWidth = fs / 10; ctx.strokeText(cellNum, sx + sw/2, sy + sh/2); ctx.fillStyle = "#00e676"; ctx.fillText(cellNum, sx + sw/2, sy + sh/2); cellNum++; } } } else { const cx = cropBox.x * canvas.width, cy = cropBox.y * canvas.height, cw = cropBox.w * canvas.width, ch = cropBox.h * canvas.height; ctx.strokeStyle = "#00e676"; ctx.lineWidth = canvas.width / 110; ctx.strokeRect(cx, cy, cw, ch); } }
    function handleStart(e) {} function handleMove(e) {} function handleEnd() {}
    async function executeAction(targetFile = null) { const fileToUse = targetFile || originalFile; if(!fileToUse) return; const btn = document.getElementById('downloadBtn'), originalText = t[currentLang].down; const targetMB = currentTargetMB, doWM = document.getElementById('wmCheck').checked, cropP = parseFloat(document.getElementById('cropInput').value) / 100; const img = await loadImage(fileToUse), base = fileToUse.name.replace(/\.[^/.]+$/, ""); if(currentTab === 'split') { const temp = document.createElement('canvas'); temp.width = img.width; temp.height = img.height; const tCtx = temp.getContext('2d'); tCtx.drawImage(img, 0, 0); if(doWM && maskData) applyEraser(tCtx, img.width, img.height); const x1 = gridBox.x1*img.width, x2 = gridBox.x2*img.width, y1 = gridBox.y1*img.height, y2 = gridBox.y2*img.height, gw = x2-x1, gh = y2-y1, fCols = [0, ...colPos, 1], fRows = [0, ...rowPos, 1], total = (fRows.length-1) * (fCols.length-1); if (isMobile) { if (mobileSplitIdx >= total) { mobileSplitIdx = 0; updateButtonText(); return; } const r = Math.floor(mobileSplitIdx / (fCols.length-1)), c = mobileSplitIdx % (fCols.length-1); let sx = x1 + fCols[c]*gw, sy = y1 + fRows[r]*gh, sw_p = (fCols[c+1]-fCols[c])*gw, sh_p = (fRows[r+1]-fRows[r])*gh; const mx = sw_p*cropP, my = sh_p*cropP, fw = Math.floor(sw_p-mx*2), fh = Math.floor(sh_p-my*2); const p = document.createElement('canvas'); p.width = fw; p.height = fh; p.getContext('2d').drawImage(temp, sx+mx, sy+my, fw, fh, 0, 0, fw, fh); p.toBlob(blob => save(blob, `${base}_${r+1}-${c+1}.${fileToUse.type.split('/')[1]}`), fileToUse.type, 1.0); mobileSplitIdx++; updateButtonText(); } else { btn.innerText = t[currentLang].wait; for(let r=0; r<fRows.length-1; r++) { for(let c=0; c<fCols.length-1; c++) { let sx = x1 + fCols[c]*gw, sy = y1 + fRows[r]*gh, sw_p = (fCols[c+1]-fCols[c])*gw, sh_p = (fRows[r+1]-fRows[r])*gh; const mx = sw_p*cropP, my = sh_p*cropP, fw = Math.floor(sw_p-mx*2), fh = Math.floor(sh_p-my*2); const p = document.createElement('canvas'); p.width = fw; p.height = fh; p.getContext('2d').drawImage(temp, sx+mx, sy+my, fw, fh, 0, 0, fw, fh); await new Promise(res => { p.toBlob(blob => { save(blob, `${base}_${r+1}-${c+1}.${fileToUse.type.split('/')[1]}`); setTimeout(res, 50); }, fileToUse.type, 1.0); }); } } btn.innerText = originalText; } } else { btn.innerText = t[currentLang].wait; const getBlob = async (q, s) => { const tw = Math.round(img.width * s), th = Math.round(img.height * s), tmp = document.createElement('canvas'); tmp.width = tw; tmp.height = th; const tc = tmp.getContext('2d'); tc.drawImage(img, 0, 0, tw, th); if(doWM && maskData) applyEraser(tc, tw, th); const cw = Math.round(cropBox.w * tw), ch = Math.round(cropBox.h * th), res = document.createElement('canvas'); res.width = cw; res.height = ch; res.getContext('2d').drawImage(tmp, Math.round(cropBox.x * tw), Math.round(cropBox.y * th), cw, ch, 0, 0, cw, ch); return new Promise(r => res.toBlob(b => r(b), 'image/jpeg', q)); }; let s = 1.0, q = 0.95, finalBlob = null; const limit = targetMB * 1024 * 1024, minLimit = limit * 0.95, lQ = 0.05, hQ = 1.0, lS = 0.5, hS = 1.0; let lowQ = lQ, highQ = hQ, lowS = lS, highS = hS; for(let i=0; i<30; i++) { q = (lowQ + highQ) / 2; s = (lowS + highS) / 2; finalBlob = await getBlob(q, s); if(finalBlob.size > limit) { highQ = q; highS = s; } else if(finalBlob.size < minLimit) { lowQ = q; lowS = s; } else break; } save(finalBlob, `${base}_target_${targetMB}MB.jpg`); btn.innerText = originalText; } }
    function applyEraser(ctx, w, h) { const imgData = ctx.getImageData(0,0,w,h), data = imgData.data, sx = w - maskW - FIX_X, sy = h - maskH - FIX_Y; for(let y=0; y<maskH; y++) { for(let x=0; x<maskW; x++) { const tx = sx + x, ty = sy + y; if(tx<0 || ty<0 || tx>=w || ty>=h) continue; const tIdx = (ty * w + tx) * 4, mIdx = (y * maskW + x) * 4, alpha = Math.min(maskData[mIdx]/255, 0.98); if(alpha < 0.05) continue; const f = 1/(1-alpha); for(let k=0; k<3; k++) data[tIdx+k] = Math.max(0, Math.min(255, (data[tIdx+k]-255*alpha)*f)); } } ctx.putImageData(imgData, 0, 0); }
    function save(blob, name) { const a = document.createElement('a'), url = URL.createObjectURL(blob); a.href = url; a.download = name; document.body.appendChild(a); a.click(); setTimeout(() => { document.body.removeChild(a); URL.revokeObjectURL(url); }, 100); }
    function loadImage(file) { return new Promise(r => { const i = new Image(), url = URL.createObjectURL(file); i.onload = () => { URL.revokeObjectURL(url); r(i); }; i.src = url; }); }
    function openPolicy(type) { document.getElementById('policyTitle').innerText = type === 'privacy' ? 'ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨' : 'ì´ìš©ì•½ê´€'; document.getElementById('policyText').innerHTML = policies[type]; document.getElementById('policyModal').classList.add('active'); }
    function closePolicy() { document.getElementById('policyModal').classList.remove('active'); }
    const policies = { privacy: `<strong>1. ê°œì¸ì •ë³´ ì²˜ë¦¬ ì›ì¹™</strong><br>Animo Pixel MasterëŠ” ì‚¬ìš©ìì˜ ì´ë¯¸ì§€ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë“  ì‘ì—…ì€ ë¸Œë¼ìš°ì € ë‚´ë¶€ì—ì„œë§Œ ìˆ˜í–‰ë©ë‹ˆë‹¤.<br><br><strong>2. ë°ì´í„° ë³´ê´€</strong><br>ì–´ë– í•œ ì´ë¯¸ì§€ ë°ì´í„°ë„ ìˆ˜ì§‘í•˜ê±°ë‚˜ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br><br><strong>3. ê´‘ê³  ë° ì¿ í‚¤</strong><br>ì• ë“œì„¼ìŠ¤ ê´‘ê³ ë¥¼ í†µí•´ ì‚¬ìš©ì ë§ì¶¤í˜• ê´‘ê³ ê°€ ê²Œì¬ë  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” êµ¬ê¸€ì˜ ì •ì±…ì„ ë”°ë¦…ë‹ˆë‹¤.`, terms: `<strong>1. ì„œë¹„ìŠ¤ ëª©ì </strong><br>ì´ë¯¸ì§€ ë¶„í•  ë° ì›Œí„°ë§ˆí¬ ì œê±° ê¸°ëŠ¥ì„ ë¬´ë£Œë¡œ ì œê³µí•©ë‹ˆë‹¤.<br><br><strong>2. ì±…ì„ì˜ í•œê³„</strong><br>ë³¸ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ ë°œìƒí•œ ê²°ê³¼ë¬¼ì— ëŒ€í•œ ë²•ì  ì±…ì„ì€ ì‚¬ìš©ìì—ê²Œ ìˆìŠµë‹ˆë‹¤.` };
</script>
</body>
</html>
